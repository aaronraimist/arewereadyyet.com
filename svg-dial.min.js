!function(t){var i="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;if("function"==typeof define&&define.amd)define(["snap","exports"],function(e,n){i.SVGDial=t(i,n,e)});else if("undefined"!=typeof exports){var e=require("snapsvg");t(i,exports,e)}else i.SVGDial=t(i,{},i.Snap)}(function(t,i,e){var n=function(t,i,e){var n=t%90/90;return i*(1-n)+e*n},o=function(t){var i=t>=0&&90>t,e=t>=90&&180>t,o=t>=180&&270>t,r=t>=270&&360>=t;return i?[n(t,0,8),n(t,8,0)]:e?[n(t,8,0),n(t,0,-8)]:o?[n(t,0,-8),n(t,-8,0)]:r?[n(t,-8,0),n(t,0,8)]:void 0},r=function(t,i){var e={},n=function(t){for(key in t)t.hasOwnProperty(key)&&(e[key]=t[key])};return n(i),n(t),e};return i.SVGDial=function(t,i){this.el=t,this.options=r(i||{},{disabled:!1,frameSize:200,ringWidth:50,frameBackgroundColor:"white",ringBackgroundColor:"#888",innerBackgroundColor:"white",fontFamily:"impact",fontSize:24,fontStyle:"none",fontWeight:"none"}),this.initialize()},i.SVGDial.create=function(t,e){return new i.SVGDial(t,e)},i.SVGDial.prototype={config:function(t){this.options=r(t,this.options)},setValue:function(t){var i=this.convertPercentageToAngle(t);this.updateDial(i)},initialize:function(){this.c=this.buildCanvas(),this.dial=this.buildDial();var t=function(t,i,e,n,o){this.updateDial(this.getAngle(e,n)),this.executeCallback("onChange",[this.percentage])},i=function(t,i,e){this.centerCoordinates=this.calculateDialCenterCoordinates(),this.updateDial(this.getAngle(t,i)),this.executeCallback("onStart",[this.percentage])},e=function(t,i,e){this.executeCallback("onEnd",[this.percentage])};this.moveKnob(this.convertPercentageToAngle(0)),this.innerCircle.drag(t,i,e,this,this,this),this.outerCircle.drag(t,i,e,this,this,this),this.executeCallback("onReady")},getAngle:function(t,i){return e.angle(this.centerCoordinates.x,this.centerCoordinates.y,t,i)},buildCanvas:function(){var t,i='<svg style="width: '+this.options.frameSize+"px; height: "+this.options.frameSize+'px;"></svg>';return t=this.el.jquery?this.el[0]:this.el instanceof HTMLElement?this.el:document.querySelector(this.el),t.innerHTML=i,e(t.getElementsByTagName("svg")[0])},buildDial:function(){this.outerCircle=this.buildOuterCircle(),this.innerCircle=this.buildInnerCircle(),this.text=this.buildText()},buildOuterCircle:function(){var t=this.outerCircleAttributes={x:this.options.frameSize/2,y:this.options.frameSize/2,radius:this.options.frameSize/2},i=function(t){return[0,0,0,t,t/2,t/2,t,t,t,0]},e=this.c.circle(t.x,t.y,t.radius);return e.attr({fill:this.c.gradient(this.calculateFillColor(this.options.ringBackgroundColor)),mask:this.c.polyline(i(this.options.frameSize)).attr({fill:this.options.frameBackgroundColor})}),e},buildInnerCircle:function(){var t=this.innerCircleAttributes={x:this.outerCircleAttributes.x,y:this.outerCircleAttributes.y,radius:this.outerCircleAttributes.radius-this.options.ringWidth},i=function(){var i,e,n=this.options.ringWidth+5,o=t.x-t.radius+5;return i=this.outerCircleAttributes.radius+.5*n,e=this.outerCircleAttributes.radius-.5*n,this.c.polyline(o,e,o,i,o-n,this.outerCircleAttributes.radius)},e=this.c.circle(t.x,t.y,t.radius),n=this.generateDropShadow(),o=i.call(this),r=this.c.group(e,o).attr({fill:this.calculateFillColor(this.options.innerBackgroundColor),filter:n,transform:["rotate(0",this.options.frameSize/2,this.options.frameSize/2].join(" ")});return r},buildText:function(){return this.c.text(this.options.frameSize/2,this.options.frameSize/2+this.options.fontSize/3,"0%").attr({fontFamily:this.options.fontFamily,fontSize:this.options.fontSize,fontWeight:this.options.fontWeight,fontStyle:this.options.fontStyle,textAnchor:"middle"})},generateDropShadow:function(t){var i=r(t||{},{x:0,y:this.options.ringWidth/20,blur:3,color:"#000",opacity:.2});return this.c.filter(e.filter.shadow(i.x,i.y,i.blur,i.color,i.opacity))},updateText:function(t){this.text.attr({text:[Math.round(100*t),"%"].join("")})},calculateFillColor:function(t){return t=t instanceof Array?t:[t],"l(0, 0.5, 1, 0.5)"+t.join("-")},convertAngleToPercentage:function(t){var i,e=315,n=225;return i=t>=e&&360>=t?45-(360-t):t+45,i/(n+45)},convertPercentageToAngle:function(t){var i=315,e=225,n=t*(e+45)+i;return n>360?n-360:n},moveKnob:function(t){var i=o(t),e=this.generateDropShadow({x:i[0],y:i[1]});this.innerCircle.attr({transform:["rotate(",t,this.options.frameSize/2,this.options.frameSize/2,")"].join(" "),filter:e})},updateDial:function(t){this.options.disabled||(315>=t&&t>270?t=315:270>=t&&t>225&&(t=225),this.moveKnob(t),this.percentage=this.convertAngleToPercentage(t),this.updateText(this.percentage))},calculateDialCenterCoordinates:function(){var t=this.outerCircle.node.getBoundingClientRect();return{x:t.left+t.height/2,y:t.top+t.height/2}},executeCallback:function(t,i){this.options[t]&&this.options[t].apply(null,i)}},i.SVGDial});